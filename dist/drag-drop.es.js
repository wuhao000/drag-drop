import{defineComponent as e,ref as a,computed as t,openBlock as r,createBlock as n,resolveDynamicComponent as d,withCtx as o,renderSlot as g,getCurrentInstance as s,withModifiers as i}from"vue";const l=e=>e.reduce(((e,a)=>(e[a]=a)&&e),{}),v=l(["drag","dragend","dragenter","dragleave","dragstart","dragover","drop"]),f=l(["copy","move","link","none"]),m=l(["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"]);var p={data:void 0},u=e({name:"Drag",props:{draggable:{type:Boolean,default:!0},transferData:{},dropEffect:{validator:e=>e in f},effectAllowed:{validator:e=>e in m},image:String,imageXOffset:{type:Number,default:0},imageYOffset:{type:Number,default:0},hideImageHtml:{type:Boolean,default:!0},tag:{type:String,default:"div"}},setup(e,{slots:r,emit:n}){const d=a(!1),o=t((()=>d.value&&e.transferData)),g=t((()=>({position:"fixed",top:"-1000px"})));return{dragging:d,scopedData:o,hideImageStyle:g,events:v,emitEvent:(a,t)=>{const o=t.dataTransfer;if([v.dragenter,v.dragover].includes(a)&&e.dropEffect&&(o.dropEffect=e.dropEffect),a===v.dragstart){if(e.effectAllowed&&(o.effectAllowed=e.effectAllowed),e.image||r.image){let a;e.image?(a=new Image,a.src=e.image):r.image&&(a=r.image()[0].el),o.setDragImage&&o.setDragImage(a,e.imageXOffset,e.imageYOffset)}void 0!==e.transferData&&(p.data=e.transferData,t.dataTransfer.setData("text","")),d.value=!0}n(a,e.transferData,t),a===v.dragend&&(p.data=void 0,d.value=!1)}}}});u.render=function(e,a,t,s,i,l){return r(),n(d(e.tag),{draggable:e.draggable,onDrag:a[1]||(a[1]=a=>e.emitEvent(e.events.drag,a)),onDragstart:a[2]||(a[2]=a=>e.emitEvent(e.events.dragstart,a)),onDragenter:a[3]||(a[3]=a=>e.emitEvent(e.events.dragenter,a)),onDragleave:a[4]||(a[4]=a=>e.emitEvent(e.events.dragleave,a)),onDragend:a[5]||(a[5]=a=>e.emitEvent(e.events.dragend,a))},{default:o((()=>[g(e.$slots,"default",{transferData:e.scopedData}),e.hideImageHtml?(r(),n("div",{key:0,style:e.hideImageStyle},[g(e.$slots,"image",{transferData:e.scopedData})],4)):g(e.$slots,"image",{key:1,transferData:e.scopedData})])),_:3},8,["draggable"])};const c=new Set;var D=e({name:"drop",props:{tag:{type:String,default:"div"}},setup(e,{emit:r}){const n=a(void 0),d=a(!1),o=t((()=>d.value&&n.value)),g=s();return{transferData:n,isDraggingOver:d,events:v,scopedData:o,emitEvent:(e,a)=>{n.value=p.data,r(e,n.value,a),e===v.dragenter&&(c.size||a.target===g.vnode.el)&&c.add(a.target),e===v.dragleave&&c.delete(a.target),e===v.drop&&c.clear(),d.value=Boolean(c.size)}}},methods:{}});function y(e){e.component("drag",u),e.component("drop",D)}D.render=function(e,a){return r(),n(d(e.tag),{onDragenter:a[1]||(a[1]=a=>e.emitEvent(e.events.dragenter,a)),onDragleave:a[2]||(a[2]=a=>e.emitEvent(e.events.dragleave,a)),onDragover:a[3]||(a[3]=i((a=>e.emitEvent(e.events.dragover,a)),["prevent"])),onDrop:a[4]||(a[4]=i((a=>e.emitEvent(e.events.drop,a)),["prevent"]))},{default:o((()=>[g(e.$slots,"default",{transferData:e.scopedData})])),_:3})};const E={install:y};export default E;export{u as Drag,D as Drop,y as install};
